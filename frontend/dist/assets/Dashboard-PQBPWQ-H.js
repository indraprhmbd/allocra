import{c as I,d as h,o as c,a as m,b as e,t as i,e as y,r as S,f as _,n as C,g as D,h as T,F as A,i as N,j as d,u as R,k as u,w as L,l as v,m as p,I as O,p as V,q as j,s as $,v as x}from"./index-CE_jnT5K.js";import{I as M}from"./IconClock-CPjfWkCF.js";import{_ as z}from"./DataTable.vue_vue_type_script_setup_true_lang-bU4LdcD9.js";import{a as f}from"./api-Ca2zvfGq.js";var B=I("outline","activity","Activity",[["path",{d:"M3 12h4l3 8l4 -16l3 8h4",key:"svg-0"}]]);const F={class:"bg-surface border border-border p-5 rounded-sm flex flex-col justify-between group hover:border-accent/50 transition-colors"},P={class:"flex items-center justify-between"},U={class:"text-xs font-mono text-muted uppercase tracking-wider"},q={class:"mt-4 flex items-end justify-between"},G={class:"text-2xl font-bold text-primary tracking-tight font-mono"},Q=h({__name:"StatCard",props:{label:{},value:{},trend:{},icon:{type:[Function,Object]}},setup(o){return(a,n)=>(c(),m("div",F,[e("div",P,[e("span",U,i(o.label),1),o.icon?(c(),y(S(o.icon),{key:0,size:16,class:"text-muted group-hover:text-accent transition-colors"})):_("",!0)]),e("div",q,[e("div",G,i(o.value),1),o.trend!==void 0?(c(),m("div",{key:0,class:C([[o.trend>=0?"text-green-500":"text-red-500"],"text-[10px] font-mono border border-current/20 px-1.5 py-0.5 rounded-sm bg-current/5"])},i(o.trend>=0?"+":"")+i(o.trend)+"% ",3)):_("",!0)])]))}}),W={class:"space-y-6"},X={class:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-4 md:gap-6"},H={class:"grid grid-cols-1 lg:grid-cols-3 gap-6"},J={class:"lg:col-span-2 space-y-4"},K={class:"text-lg font-semibold text-white flex items-center gap-2"},Y={class:"bg-surface border border-border rounded-sm overflow-hidden"},Z={class:"overflow-x-auto"},ee={class:"space-y-4 hidden lg:block"},te={class:"text-lg font-semibold text-white flex items-center gap-2"},se={class:"bg-surface border border-border rounded-sm p-5"},ae={class:"space-y-4"},oe={class:"flex justify-between text-[10px] font-mono text-muted mb-1.5 uppercase"},ne={class:"h-1 bg-background rounded-full overflow-hidden"},le={class:"flex justify-between text-[10px] font-mono text-muted mb-1.5 uppercase"},re={class:"h-1 bg-background rounded-full overflow-hidden"},ie={class:"flex justify-between text-[10px] font-mono text-muted mb-1.5 uppercase"},ce={class:"h-1 bg-background rounded-full overflow-hidden"},ve=h({__name:"Dashboard",setup(o){const a=p([{label:"Total Resources",value:"0",icon:O},{label:"Active Allocations",value:"0",icon:V},{label:"Pending Requests",value:"0",icon:M},{label:"Detected Conflicts",value:"0",icon:j}]),n=p({cpu_usage:0,memory_usage:0,io_wait:0,status:"OFFLINE"}),w=async()=>{try{const[g,t,l]=await Promise.all([f.get("/rooms"),f.get("/bookings/all"),f.get("/system/stats")]);if(l.data){a.value[0]&&(a.value[0].value=(l.data.total_bookings||0).toString()),a.value[1]&&(a.value[1].value=(l.data.active_bookings||0).toString()),a.value[3]&&(a.value[3].value=(l.data.conflicts||0).toString());const s=l.data.cpu_usage||0,r=l.data.memory_usage||0,E=l.data.utilization||0;n.value={...n.value,cpu_usage:Math.round(s),memory_usage:Math.round(r),io_wait:Math.round(E*.2),status:s>90?"OVERLOAD":s>.1?"ONLINE":"IDLE"}}a.value[0]&&(a.value[0].value=g.data.length.toString()),a.value[2]&&(a.value[2].value=t.data.filter(s=>s.status==="pending").length.toString()),b.value=t.data.sort((s,r)=>new Date(r.created_at).getTime()-new Date(s.created_at).getTime()).slice(0,5).map(s=>({timestamp:new Date(s.created_at).toLocaleString(),resource:s.room_name||`NODE-ID-${s.room_id}`,event:s.status==="approved"?"ALLOCATION_START":s.status==="pending"?"RESERVATION_REQUEST":"CONFLICT_DETECTED",status:s.status.toUpperCase()}))}catch{console.error("Dashboard sync error")}};D(()=>{w()});const k=[{key:"timestamp",label:"Timestamp",class:"w-48 font-mono text-xs"},{key:"resource",label:"Resource"},{key:"event",label:"Event Type"},{key:"status",label:"Status",class:"text-right"}],b=p([]);return(g,t)=>{const l=x("StatusBadge"),s=x("IconCpu");return c(),m("div",W,[t[6]||(t[6]=T('<div class="flex items-center justify-between"><h1 class="text-2xl font-bold tracking-tight text-white">Dashboard</h1><div class="flex items-center gap-2"><span class="w-2 h-2 bg-green-500 rounded-full animate-pulse"></span><span class="text-xs font-mono text-accent">LIVE_STREAM</span></div></div>',1)),e("div",X,[(c(!0),m(A,null,N(a.value,r=>(c(),y(Q,$({key:r.label},{ref_for:!0},r,{class:"bg-surface border border-border p-4"}),null,16))),128))]),e("div",H,[e("div",J,[e("h2",K,[d(R(B),{size:20,class:"text-accent"}),t[0]||(t[0]=u(" Latest Allocation Events ",-1))]),e("div",Y,[e("div",Z,[d(z,{columns:k,items:b.value,loading:!1},{status:L(({value:r})=>[d(l,{status:r},null,8,["status"])]),_:1},8,["items"])])])]),e("div",ee,[e("h2",te,[d(s,{size:20,class:"text-accent"}),t[1]||(t[1]=u(" Engine Load ",-1))]),e("div",se,[e("div",ae,[e("div",null,[e("div",oe,[t[2]||(t[2]=e("span",null,"CPU Usage",-1)),e("span",null,i(n.value.cpu_usage)+"%",1)]),e("div",ne,[e("div",{class:"h-full bg-accent transition-all duration-500",style:v({width:n.value.cpu_usage+"%"})},null,4)])]),e("div",null,[e("div",le,[t[3]||(t[3]=e("span",null,"Memory",-1)),e("span",null,i(n.value.memory_usage)+"%",1)]),e("div",re,[e("div",{class:"h-full bg-accent transition-all duration-500",style:v({width:n.value.memory_usage+"%"})},null,4)])]),e("div",null,[e("div",ie,[t[4]||(t[4]=e("span",null,"I/O Wait",-1)),e("span",null,i(n.value.io_wait)+"%",1)]),e("div",ce,[e("div",{class:"h-full bg-accent transition-all duration-500",style:v({width:n.value.io_wait+"%"})},null,4)])])])]),t[5]||(t[5]=e("div",{class:"bg-surface border border-border rounded-sm p-5 border-l-4 border-l-accent"},[e("h3",{class:"text-xs font-bold uppercase tracking-widest text-accent mb-2"}," Notice "),e("p",{class:"text-xs text-muted leading-relaxed"},[u(" Automatic conflict resolution is currently set to "),e("span",{class:"text-primary"},"PRESERVE_EXISTING"),u(". Change this in system settings if preemption is required. ")])],-1))])])])}}});export{ve as default};
