import{c as C,d as y,o as i,a as u,b as e,t as l,e as w,r as I,f as x,n as E,g as T,h as c,u as g,i as d,F as N,j as L,I as _,w as A,k as v,l as p,m as R,p as O,q as j}from"./index-DmJMoqH0.js";import{I as V}from"./IconClock-D4aKCr8i.js";import{_ as z}from"./DataTable.vue_vue_type_script_setup_true_lang-sBdJk8S_.js";import{a as b}from"./api-Ca2zvfGq.js";var h=C("outline","activity","Activity",[["path",{d:"M3 12h4l3 8l4 -16l3 8h4",key:"svg-0"}]]);const $={class:"bg-surface border border-border p-5 rounded-sm flex flex-col justify-between group hover:border-accent/50 transition-colors"},M={class:"flex items-center justify-between"},F={class:"text-xs font-mono text-muted uppercase tracking-wider"},P={class:"mt-4 flex items-end justify-between"},U={class:"text-2xl font-bold text-primary tracking-tight font-mono"},B=y({__name:"StatCard",props:{label:{},value:{},trend:{},icon:{type:[Function,Object]}},setup(n){return(a,r)=>(i(),u("div",$,[e("div",M,[e("span",F,l(n.label),1),n.icon?(i(),w(I(n.icon),{key:0,size:16,class:"text-muted group-hover:text-accent transition-colors"})):x("",!0)]),e("div",P,[e("div",U,l(n.value),1),n.trend!==void 0?(i(),u("div",{key:0,class:E([[n.trend>=0?"text-green-500":"text-red-500"],"text-[10px] font-mono border border-current/20 px-1.5 py-0.5 rounded-sm bg-current/5"])},l(n.trend>=0?"+":"")+l(n.trend)+"% ",3)):x("",!0)])]))}}),q={class:"space-y-8"},G={class:"flex items-end justify-between"},W={class:"flex items-center gap-2 text-xs font-mono text-muted uppercase tracking-widest border-b border-border pb-1"},K={class:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6"},Q={class:"grid grid-cols-1 lg:grid-cols-3 gap-8"},X={class:"lg:col-span-2 bg-surface border border-border rounded-sm overflow-hidden flex flex-col"},H={class:"p-5 border-b border-border flex items-center justify-between"},J={class:"text-sm font-bold uppercase tracking-widest text-primary flex items-center gap-2"},Y={class:"space-y-8"},Z={class:"bg-surface border border-border rounded-sm p-5"},ee={class:"text-sm font-bold uppercase tracking-widest text-primary mb-4 flex items-center gap-2"},te={class:"space-y-4"},se={class:"flex justify-between text-[10px] font-mono text-muted mb-1.5 uppercase"},ae={class:"h-1 bg-background rounded-full overflow-hidden"},oe={class:"flex justify-between text-[10px] font-mono text-muted mb-1.5 uppercase"},ne={class:"h-1 bg-background rounded-full overflow-hidden"},re={class:"flex justify-between text-[10px] font-mono text-muted mb-1.5 uppercase"},le={class:"h-1 bg-background rounded-full overflow-hidden"},me=y({__name:"Dashboard",setup(n){const a=p([{label:"Total Resources",value:"0",icon:R,trend:0},{label:"Active Allocations",value:"0",icon:_,trend:0},{label:"Pending Requests",value:"0",icon:V,trend:0},{label:"Detected Conflicts",value:"0",icon:O,trend:0}]),r=p({cpu_usage:0,memory_usage:0,io_wait:0,status:"OFFLINE"}),k=async()=>{try{const[m,t,o]=await Promise.all([b.get("/rooms"),b.get("/bookings/all"),b.get("/system/stats")]);if(o.data){a.value[0]&&(a.value[0].value=(o.data.total_bookings||0).toString()),a.value[1]&&(a.value[1].value=(o.data.active_bookings||0).toString()),a.value[1]&&(a.value[1].value=(o.data.active_bookings||0).toString()),a.value[3]&&(a.value[3].value=(o.data.conflicts||0).toString());const s=o.data.utilization||0;r.value={...r.value,cpu_usage:Math.round(s),memory_usage:Math.round(s*.8+10),io_wait:Math.round(s*.3),status:s>90?"OVERLOAD":s>0?"ONLINE":"IDLE"}}a.value[0]&&(a.value[0].value=m.data.length.toString()),a.value[2]&&(a.value[2].value=t.data.filter(s=>s.status==="pending").length.toString()),f.value=t.data.sort((s,D)=>new Date(D.created_at).getTime()-new Date(s.created_at).getTime()).slice(0,5).map(s=>({timestamp:new Date(s.created_at).toLocaleString(),resource:s.room_name||`NODE-ID-${s.room_id}`,event:s.status==="approved"?"ALLOCATION_START":s.status==="pending"?"RESERVATION_REQUEST":"CONFLICT_DETECTED",status:s.status.toUpperCase()}))}catch{console.error("Dashboard sync error")}};T(()=>{k()});const S=[{key:"timestamp",label:"Timestamp",class:"w-48 font-mono text-xs"},{key:"resource",label:"Resource"},{key:"event",label:"Event Type"},{key:"status",label:"Status",class:"text-right"}],f=p([]);return(m,t)=>(i(),u("div",q,[e("div",G,[t[0]||(t[0]=e("div",null,[e("h2",{class:"text-2xl font-bold text-primary tracking-tight"}," System Dashboard "),e("p",{class:"text-muted text-sm mt-1"}," Real-time resource utilization and allocation metrics. ")],-1)),e("div",W,[c(g(h),{size:14,class:"text-accent animate-pulse"}),d(" LIVE_STREAM_CONNECTED: "+l(new Date().toLocaleTimeString()),1)])]),e("div",K,[(i(!0),u(N,null,L(a.value,o=>(i(),w(B,j({key:o.label},{ref_for:!0},o),null,16))),128))]),e("div",Q,[e("div",X,[e("div",H,[e("h3",J,[c(g(_),{size:16,class:"text-accent"}),t[1]||(t[1]=d(" Latest Allocation Events ",-1))]),t[2]||(t[2]=e("button",{class:"text-[10px] font-mono text-muted hover:text-accent transition-colors"}," VIEW_ALL_LOGS ",-1))]),c(z,{columns:S,items:f.value},{status:A(({value:o})=>[e("span",{class:E([[o==="SUCCESS"||o==="OK"?"text-green-500":o==="PENDING"?"text-accent":"text-red-500"],"text-[10px] font-mono px-1.5 py-0.5 border border-current/20 bg-current/5 rounded-sm"])},l(o),3)]),_:1},8,["items"])]),e("div",Y,[e("div",Z,[e("h3",ee,[c(g(h),{size:16,class:"text-accent"}),t[3]||(t[3]=d(" Engine Load ",-1))]),e("div",te,[e("div",null,[e("div",se,[t[4]||(t[4]=e("span",null,"CPU Usage",-1)),e("span",null,l(r.value.cpu_usage)+"%",1)]),e("div",ae,[e("div",{class:"h-full bg-accent transition-all duration-500",style:v({width:r.value.cpu_usage+"%"})},null,4)])]),e("div",null,[e("div",oe,[t[5]||(t[5]=e("span",null,"Memory",-1)),e("span",null,l(r.value.memory_usage)+"%",1)]),e("div",ne,[e("div",{class:"h-full bg-accent transition-all duration-500",style:v({width:r.value.memory_usage+"%"})},null,4)])]),e("div",null,[e("div",re,[t[6]||(t[6]=e("span",null,"I/O Wait",-1)),e("span",null,l(r.value.io_wait)+"%",1)]),e("div",le,[e("div",{class:"h-full bg-accent transition-all duration-500",style:v({width:r.value.io_wait+"%"})},null,4)])])])]),t[7]||(t[7]=e("div",{class:"bg-surface border border-border rounded-sm p-5 border-l-4 border-l-accent"},[e("h3",{class:"text-xs font-bold uppercase tracking-widest text-accent mb-2"}," Notice "),e("p",{class:"text-xs text-muted leading-relaxed"},[d(" Automatic conflict resolution is currently set to "),e("span",{class:"text-primary"},"PRESERVE_EXISTING"),d(". Change this in system settings if preemption is required. ")])],-1))])])]))}});export{me as default};
