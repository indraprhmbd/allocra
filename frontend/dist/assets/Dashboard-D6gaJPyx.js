import{c as D,d as y,o as i,a as u,b as e,t as r,e as w,r as T,f as v,n as E,g as I,h as c,u as p,i as d,F as N,j as A,I as _,w as R,k as g,l as x,m as L,p as j,q as O}from"./index-Cnm_OeQY.js";import{I as V}from"./IconClock-DuY6ra5I.js";import{_ as $}from"./DataTable.vue_vue_type_script_setup_true_lang-CfpRG3PM.js";import{a as b}from"./api-Ca2zvfGq.js";var h=D("outline","activity","Activity",[["path",{d:"M3 12h4l3 8l4 -16l3 8h4",key:"svg-0"}]]);const z={class:"bg-surface border border-border p-5 rounded-sm flex flex-col justify-between group hover:border-accent/50 transition-colors"},F={class:"flex items-center justify-between"},P={class:"text-xs font-mono text-muted uppercase tracking-wider"},U={class:"mt-4 flex items-end justify-between"},B={class:"text-2xl font-bold text-primary tracking-tight font-mono"},M=y({__name:"StatCard",props:{label:{},value:{},trend:{},icon:{type:[Function,Object]}},setup(o){return(a,l)=>(i(),u("div",z,[e("div",F,[e("span",P,r(o.label),1),o.icon?(i(),w(T(o.icon),{key:0,size:16,class:"text-muted group-hover:text-accent transition-colors"})):v("",!0)]),e("div",U,[e("div",B,r(o.value),1),o.trend!==void 0?(i(),u("div",{key:0,class:E([[o.trend>=0?"text-green-500":"text-red-500"],"text-[10px] font-mono border border-current/20 px-1.5 py-0.5 rounded-sm bg-current/5"])},r(o.trend>=0?"+":"")+r(o.trend)+"% ",3)):v("",!0)])]))}}),q={class:"space-y-8"},G={class:"flex items-end justify-between"},W={class:"flex items-center gap-2 text-xs font-mono text-muted uppercase tracking-widest border-b border-border pb-1"},K={class:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6"},Q={class:"grid grid-cols-1 lg:grid-cols-3 gap-8"},X={class:"lg:col-span-2 bg-surface border border-border rounded-sm overflow-hidden flex flex-col"},H={class:"p-5 border-b border-border flex items-center justify-between"},J={class:"text-sm font-bold uppercase tracking-widest text-primary flex items-center gap-2"},Y={class:"space-y-8"},Z={class:"bg-surface border border-border rounded-sm p-5"},ee={class:"text-sm font-bold uppercase tracking-widest text-primary mb-4 flex items-center gap-2"},te={class:"space-y-4"},se={class:"flex justify-between text-[10px] font-mono text-muted mb-1.5 uppercase"},ae={class:"h-1 bg-background rounded-full overflow-hidden"},oe={class:"flex justify-between text-[10px] font-mono text-muted mb-1.5 uppercase"},ne={class:"h-1 bg-background rounded-full overflow-hidden"},re={class:"flex justify-between text-[10px] font-mono text-muted mb-1.5 uppercase"},le={class:"h-1 bg-background rounded-full overflow-hidden"},me=y({__name:"Dashboard",setup(o){const a=x([{label:"Total Resources",value:"0",icon:L,trend:0},{label:"Active Allocations",value:"0",icon:_,trend:0},{label:"Pending Requests",value:"0",icon:V,trend:0},{label:"Detected Conflicts",value:"0",icon:j,trend:0}]),l=x({cpu_usage:0,memory_usage:0,io_wait:0,status:"OFFLINE"}),k=async()=>{try{const[m,t,n]=await Promise.all([b.get("/rooms"),b.get("/bookings/all"),b.get("/system/stats")]);l.value=n.data,a.value[0]&&(a.value[0].value=m.data.length.toString()),a.value[1]&&(a.value[1].value=t.data.filter(s=>s.status==="approved").length.toString()),a.value[2]&&(a.value[2].value=t.data.filter(s=>s.status==="pending").length.toString()),a.value[3]&&(a.value[3].value=t.data.filter(s=>s.status==="rejected").length.toString()),f.value=t.data.sort((s,C)=>new Date(C.created_at).getTime()-new Date(s.created_at).getTime()).slice(0,5).map(s=>({timestamp:new Date(s.created_at).toLocaleString(),resource:s.room_name||`NODE-ID-${s.room_id}`,event:s.status==="approved"?"ALLOCATION_START":s.status==="pending"?"RESERVATION_REQUEST":"CONFLICT_DETECTED",status:s.status.toUpperCase()}))}catch{console.error("Dashboard sync error")}};I(()=>{k()});const S=[{key:"timestamp",label:"Timestamp",class:"w-48 font-mono text-xs"},{key:"resource",label:"Resource"},{key:"event",label:"Event Type"},{key:"status",label:"Status",class:"text-right"}],f=x([]);return(m,t)=>(i(),u("div",q,[e("div",G,[t[0]||(t[0]=e("div",null,[e("h2",{class:"text-2xl font-bold text-primary tracking-tight"}," System Dashboard "),e("p",{class:"text-muted text-sm mt-1"}," Real-time resource utilization and allocation metrics. ")],-1)),e("div",W,[c(p(h),{size:14,class:"text-accent animate-pulse"}),d(" LIVE_STREAM_CONNECTED: "+r(new Date().toLocaleTimeString()),1)])]),e("div",K,[(i(!0),u(N,null,A(a.value,n=>(i(),w(M,O({key:n.label},{ref_for:!0},n),null,16))),128))]),e("div",Q,[e("div",X,[e("div",H,[e("h3",J,[c(p(_),{size:16,class:"text-accent"}),t[1]||(t[1]=d(" Latest Allocation Events ",-1))]),t[2]||(t[2]=e("button",{class:"text-[10px] font-mono text-muted hover:text-accent transition-colors"}," VIEW_ALL_LOGS ",-1))]),c($,{columns:S,items:f.value},{status:R(({value:n})=>[e("span",{class:E([[n==="SUCCESS"||n==="OK"?"text-green-500":n==="PENDING"?"text-accent":"text-red-500"],"text-[10px] font-mono px-1.5 py-0.5 border border-current/20 bg-current/5 rounded-sm"])},r(n),3)]),_:1},8,["items"])]),e("div",Y,[e("div",Z,[e("h3",ee,[c(p(h),{size:16,class:"text-accent"}),t[3]||(t[3]=d(" Engine Load ",-1))]),e("div",te,[e("div",null,[e("div",se,[t[4]||(t[4]=e("span",null,"CPU Usage",-1)),e("span",null,r(l.value.cpu_usage)+"%",1)]),e("div",ae,[e("div",{class:"h-full bg-accent transition-all duration-500",style:g({width:l.value.cpu_usage+"%"})},null,4)])]),e("div",null,[e("div",oe,[t[5]||(t[5]=e("span",null,"Memory",-1)),e("span",null,r(l.value.memory_usage)+"%",1)]),e("div",ne,[e("div",{class:"h-full bg-accent transition-all duration-500",style:g({width:l.value.memory_usage+"%"})},null,4)])]),e("div",null,[e("div",re,[t[6]||(t[6]=e("span",null,"I/O Wait",-1)),e("span",null,r(l.value.io_wait)+"%",1)]),e("div",le,[e("div",{class:"h-full bg-accent transition-all duration-500",style:g({width:l.value.io_wait+"%"})},null,4)])])])]),t[7]||(t[7]=e("div",{class:"bg-surface border border-border rounded-sm p-5 border-l-4 border-l-accent"},[e("h3",{class:"text-xs font-bold uppercase tracking-widest text-accent mb-2"}," Notice "),e("p",{class:"text-xs text-muted leading-relaxed"},[d(" Automatic conflict resolution is currently set to "),e("span",{class:"text-primary"},"PRESERVE_EXISTING"),d(". Change this in system settings if preemption is required. ")])],-1))])])]))}});export{me as default};
