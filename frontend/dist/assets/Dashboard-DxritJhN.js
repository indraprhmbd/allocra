import{c as E,d as h,o as d,a as m,b as e,t as r,e as y,r as I,f as x,n as S,g as C,h as D,F as T,i as A,j as c,u as N,k as u,w as R,l as v,m as p,I as L,p as O,q as V,s as j,v as _}from"./index-C2XaiYtm.js";import{I as $}from"./IconClock-1Ctjoic1.js";import{_ as M}from"./DataTable.vue_vue_type_script_setup_true_lang-CEe1Cpmc.js";import{a as f}from"./api-Ca2zvfGq.js";var z=E("outline","activity","Activity",[["path",{d:"M3 12h4l3 8l4 -16l3 8h4",key:"svg-0"}]]);const B={class:"bg-surface border border-border p-5 rounded-sm flex flex-col justify-between group hover:border-accent/50 transition-colors"},F={class:"flex items-center justify-between"},P={class:"text-xs font-mono text-muted uppercase tracking-wider"},U={class:"mt-4 flex items-end justify-between"},q={class:"text-2xl font-bold text-primary tracking-tight font-mono"},G=h({__name:"StatCard",props:{label:{},value:{},trend:{},icon:{type:[Function,Object]}},setup(o){return(a,n)=>(d(),m("div",B,[e("div",F,[e("span",P,r(o.label),1),o.icon?(d(),y(I(o.icon),{key:0,size:16,class:"text-muted group-hover:text-accent transition-colors"})):x("",!0)]),e("div",U,[e("div",q,r(o.value),1),o.trend!==void 0?(d(),m("div",{key:0,class:S([[o.trend>=0?"text-green-500":"text-red-500"],"text-[10px] font-mono border border-current/20 px-1.5 py-0.5 rounded-sm bg-current/5"])},r(o.trend>=0?"+":"")+r(o.trend)+"% ",3)):x("",!0)])]))}}),Q={class:"space-y-6"},W={class:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-4 md:gap-6"},X={class:"grid grid-cols-1 lg:grid-cols-3 gap-6"},H={class:"lg:col-span-2 space-y-4"},J={class:"text-lg font-semibold text-white flex items-center gap-2"},K={class:"bg-surface border border-border rounded-sm overflow-hidden"},Y={class:"overflow-x-auto"},Z={class:"space-y-4 hidden lg:block"},ee={class:"text-lg font-semibold text-white flex items-center gap-2"},te={class:"bg-surface border border-border rounded-sm p-5"},se={class:"space-y-4"},ae={class:"flex justify-between text-[10px] font-mono text-muted mb-1.5 uppercase"},oe={class:"h-1 bg-background rounded-full overflow-hidden"},ne={class:"flex justify-between text-[10px] font-mono text-muted mb-1.5 uppercase"},le={class:"h-1 bg-background rounded-full overflow-hidden"},re={class:"flex justify-between text-[10px] font-mono text-muted mb-1.5 uppercase"},ie={class:"h-1 bg-background rounded-full overflow-hidden"},ge=h({__name:"Dashboard",setup(o){const a=p([{label:"Total Resources",value:"0",icon:L,trend:0},{label:"Active Allocations",value:"0",icon:O,trend:0},{label:"Pending Requests",value:"0",icon:$,trend:0},{label:"Detected Conflicts",value:"0",icon:V,trend:0}]),n=p({cpu_usage:0,memory_usage:0,io_wait:0,status:"OFFLINE"}),w=async()=>{try{const[g,s,l]=await Promise.all([f.get("/rooms"),f.get("/bookings/all"),f.get("/system/stats")]);if(l.data){a.value[0]&&(a.value[0].value=(l.data.total_bookings||0).toString()),a.value[1]&&(a.value[1].value=(l.data.active_bookings||0).toString()),a.value[3]&&(a.value[3].value=(l.data.conflicts||0).toString());const t=l.data.utilization||0;n.value={...n.value,cpu_usage:Math.round(t),memory_usage:Math.round(t*.8+10),io_wait:Math.round(t*.3),status:t>90?"OVERLOAD":t>0?"ONLINE":"IDLE"}}a.value[0]&&(a.value[0].value=g.data.length.toString()),a.value[2]&&(a.value[2].value=s.data.filter(t=>t.status==="pending").length.toString()),b.value=s.data.sort((t,i)=>new Date(i.created_at).getTime()-new Date(t.created_at).getTime()).slice(0,5).map(t=>({timestamp:new Date(t.created_at).toLocaleString(),resource:t.room_name||`NODE-ID-${t.room_id}`,event:t.status==="approved"?"ALLOCATION_START":t.status==="pending"?"RESERVATION_REQUEST":"CONFLICT_DETECTED",status:t.status.toUpperCase()}))}catch{console.error("Dashboard sync error")}};C(()=>{w()});const k=[{key:"timestamp",label:"Timestamp",class:"w-48 font-mono text-xs"},{key:"resource",label:"Resource"},{key:"event",label:"Event Type"},{key:"status",label:"Status",class:"text-right"}],b=p([]);return(g,s)=>{const l=_("StatusBadge"),t=_("IconCpu");return d(),m("div",Q,[s[6]||(s[6]=D('<div class="flex items-center justify-between"><h1 class="text-2xl font-bold tracking-tight text-white">Dashboard</h1><div class="flex items-center gap-2"><span class="w-2 h-2 bg-green-500 rounded-full animate-pulse"></span><span class="text-xs font-mono text-accent">LIVE_STREAM</span></div></div>',1)),e("div",W,[(d(!0),m(T,null,A(a.value,i=>(d(),y(G,j({key:i.label},{ref_for:!0},i,{class:"bg-surface border border-border p-4"}),null,16))),128))]),e("div",X,[e("div",H,[e("h2",J,[c(N(z),{size:20,class:"text-accent"}),s[0]||(s[0]=u(" Latest Allocation Events ",-1))]),e("div",K,[e("div",Y,[c(M,{columns:k,items:b.value,loading:!1},{status:R(({value:i})=>[c(l,{status:i},null,8,["status"])]),_:1},8,["items"])])])]),e("div",Z,[e("h2",ee,[c(t,{size:20,class:"text-accent"}),s[1]||(s[1]=u(" Engine Load ",-1))]),e("div",te,[e("div",se,[e("div",null,[e("div",ae,[s[2]||(s[2]=e("span",null,"CPU Usage",-1)),e("span",null,r(n.value.cpu_usage)+"%",1)]),e("div",oe,[e("div",{class:"h-full bg-accent transition-all duration-500",style:v({width:n.value.cpu_usage+"%"})},null,4)])]),e("div",null,[e("div",ne,[s[3]||(s[3]=e("span",null,"Memory",-1)),e("span",null,r(n.value.memory_usage)+"%",1)]),e("div",le,[e("div",{class:"h-full bg-accent transition-all duration-500",style:v({width:n.value.memory_usage+"%"})},null,4)])]),e("div",null,[e("div",re,[s[4]||(s[4]=e("span",null,"I/O Wait",-1)),e("span",null,r(n.value.io_wait)+"%",1)]),e("div",ie,[e("div",{class:"h-full bg-accent transition-all duration-500",style:v({width:n.value.io_wait+"%"})},null,4)])])])]),s[5]||(s[5]=e("div",{class:"bg-surface border border-border rounded-sm p-5 border-l-4 border-l-accent"},[e("h3",{class:"text-xs font-bold uppercase tracking-widest text-accent mb-2"}," Notice "),e("p",{class:"text-xs text-muted leading-relaxed"},[u(" Automatic conflict resolution is currently set to "),e("span",{class:"text-primary"},"PRESERVE_EXISTING"),u(". Change this in system settings if preemption is required. ")])],-1))])])])}}});export{ge as default};
